<!DOCTYPE html><!-- [if lt IE 7]>
<html lang="en" class="ie ie6"></html><![endif]-->
<!-- [if IE 7]>
<html lang="en" class="ie ie7"></html><![endif]-->
<!-- [if IE 8]>
<html lang="en" class="ie ie8"></html><![endif]-->
<!-- [if (gte IE 9)|!(IE)]>
<html lang="en"></html><![endif]-->
<head>
  <!-- Basic Page Needs-->
  <meta charset="utf-8">
  <title>Karma - Preprocessors</title>
  <!-- Mobile specific Metas-->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <!-- Le styles-->
  <link href="/assets/css/app.css" rel="stylesheet">
  <!-- HTML5 shim, for IE6-8 support of HTML5 elements--><!-- [if lt IE 9]>
  <script src="/assets/js/html5.js"></script><![endif]-->
  <!-- Fav and touch icons-->
  <link rel="shortcut icon" href="/assets/img/favicon/favicon.ico">
  <link rel="apple-touch-icon" href="/assets/img/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/img/apple-touch-icon-144x144.png">
  <!-- canonical link for search engines-->
  <link href="http://karma-runner.github.io/6.3/config/preprocessors.html" rel="canonical">
</head>
<body>
  <div id="wrap" class="boxed">
    <header>
      <div class="flash">
        <b>Heads Up!</b> You're viewing the docs for <b>v6.2</b>, an old version of Karma.
        <a href="/6.3/config/preprocessors.html"><b>v6.3</b> is the newest</a>.
      </div>
      <div class="container clearfix">
        <div class="six columns">
          <div class="logo"><a href="/6.2/index.html"><img src="/assets/img/banner.png" alt="Karma - Spectacular Test Runner for JavaScript" title="Karma - Spectacular Test Runner for JavaScript"></a></div>
        </div>
        <div class="ten columns">
          <nav id="menu" class="navigation">
            <ul id="nav">
              <li><a href="javascript:void">intro</a>
                <ul>
                  <li><a href="/6.2/intro/installation.html">Installation</a></li>
                  <li><a href="/6.2/intro/configuration.html">Configuration</a></li>
                  <li><a href="/6.2/intro/how-it-works.html">How It Works</a></li>
                  <li><a href="/6.2/intro/faq.html">FAQ</a></li>
                  <li><a href="/6.2/intro/troubleshooting.html">Troubleshooting</a></li>
                </ul>
              </li>
              <li><a href="javascript:void" class="active">config</a>
                <ul>
                  <li><a href="/6.2/config/configuration-file.html">Configuration File</a></li>
                  <li><a href="/6.2/config/files.html">Files</a></li>
                  <li><a href="/6.2/config/browsers.html">Browsers</a></li>
                  <li><a href="/6.2/config/preprocessors.html">Preprocessors</a></li>
                  <li><a href="/6.2/config/plugins.html">Plugins</a></li>
                </ul>
              </li>
              <li><a href="javascript:void">plus</a>
                <ul>
                  <li><a href="/6.2/plus/requirejs.html">RequireJS</a></li>
                  <li><a href="/6.2/plus/travis.html">Travis CI</a></li>
                  <li><a href="/6.2/plus/jenkins.html">Jenkins CI</a></li>
                  <li><a href="/6.2/plus/semaphore.html">Semaphore CI</a></li>
                  <li><a href="/6.2/plus/cloud9.html">Cloud9</a></li>
                  <li><a href="/6.2/plus/angularjs.html">AngularJS</a></li>
                  <li><a href="/6.2/plus/yeoman.html">Yeoman</a></li>
                  <li><a href="/6.2/plus/emberjs.html">Ember.js</a></li>
                  <li><a href="/6.2/plus/codio.html">Codio</a></li>
                  <li><a href="/6.2/plus/teamcity.html">TeamCity</a></li>
                </ul>
              </li>
              <li><a href="javascript:void">dev</a>
                <ul>
                  <li><a href="/6.2/dev/contributing.html">Contributing</a></li>
                  <li><a href="/6.2/dev/making-changes.html">Making Changes</a></li>
                  <li><a href="/6.2/dev/maintaining.html">Maintaining</a></li>
                  <li><a href="/6.2/dev/public-api.html">Public Api</a></li>
                  <li><a href="/6.2/dev/plugins.html">Plugins</a></li>
                </ul>
              </li>
              <li><a href="javascript:void">about</a>
                <ul>
                  <li><a href="/6.2/about/versioning.html">Versioning</a></li>
                  <li><a href="/6.2/about/changelog.html">Changelog</a></li>
                  <li><a href="/6.2/about/migration.html">Migration</a></li>
                </ul>
              </li>
              <li><a href="javascript:void">v6.2</a>
                <ul>
                  <li><a href="/6.3/index.html">v6.3</a></li>
                  <li><a href="/6.2/index.html">v6.2</a></li>
                  <li><a href="/6.1/index.html">v6.1</a></li>
                  <li><a href="/6.0/index.html">v6.0</a></li>
                  <li><a href="/5.2/index.html">v5.2</a></li>
                  <li><a href="/5.1/index.html">v5.1</a></li>
                  <li><a href="/5.0/index.html">v5.0</a></li>
                  <li><a href="/4.0/index.html">v4.0</a></li>
                  <li><a href="/3.0/index.html">v3.0</a></li>
                  <li><a href="/2.0/index.html">v2.0</a></li>
                  <li><a href="/1.0/index.html">v1.0</a></li>
                  <li><a href="/0.13/index.html">v0.13</a></li>
                  <li><a href="/0.12/index.html">v0.12</a></li>
                  <li><a href="/0.10/index.html">v0.10</a></li>
                  <li><a href="/0.8/index.html">v0.8</a></li>
                  <li><a href="/0.6/index.html">v0.6</a></li>
                </ul>
              </li>
            </ul>
          </nav>
        </div>
        <div class="sixteen columns">
          <hr>
        </div>
      </div>
    </header>
    <div class="container clearfix">
      <div class="sixteen columns">
        <h1 class="page-title">Preprocessors<span class="line"></span>
        </h1>
      </div>
      <div class="page-columns">
        <div id="markdown" class="sixteen columns bottom"><p>Preprocessors in Karma allow you to do some work with your files before
they get served to the browser. These are configured in the <code>preprocessors</code> block
of the configuration file:</p>
<pre><code class="language-javascript">preprocessors: {
  <span class="hljs-string">&#x27;**/*.coffee&#x27;</span>: [<span class="hljs-string">&#x27;coffee&#x27;</span>],
  <span class="hljs-string">&#x27;**/*.tea&#x27;</span>: [<span class="hljs-string">&#x27;coffee&#x27;</span>],
  <span class="hljs-string">&#x27;**/*.html&#x27;</span>: [<span class="hljs-string">&#x27;html2js&#x27;</span>]
},
</code></pre>
<div class="alert alert-success"><h4 class="alert-heading">Note: </h4>There are multiple expressions referencing the &quot;coffee&quot; preprocessor in this example, as a preprocessor
can be listed more than once as another way to specify multiple file path expressions.</div>
<div class="alert alert-success"><h4 class="alert-heading">Note: </h4>Most of the preprocessors need to be loaded as <a href="plugins.html">plugins</a>.</div>
<h2>Available Preprocessors</h2>
<ul>
<li><a href="https://github.com/karma-runner/karma-coffee-preprocessor">coffee</a></li>
<li><a href="https://github.com/karma-runner/karma-html2js-preprocessor">html2js</a><ul>
<li>Note any .html files listed in the files section must be referenced at run time as <code>window.__html__[&#39;template.html&#39;]</code>. <a href="https://github.com/karma-runner/karma-html2js-preprocessor#how-does-it-work-">Learn more</a>.</li>
<li>If this preprocessor is disabled, included .html files will need <code>base/</code> added to beginning of their path reference. See <a href="https://github.com/karma-runner/karma/issues/788">discussion in issue 788</a>.</li>
</ul>
</li>
<li><a href="https://github.com/karma-runner/karma-coverage">coverage</a></li>
<li><a href="https://github.com/karma-runner/karma-ng-html2js-preprocessor">ng-html2js</a></li>
<li><a href="https://www.npmjs.org/browse/keyword/karma-preprocessor">many more</a></li>
</ul>
<p>Here&#39;s an example of how to add the CoffeScript preprocessor to your testing suite:</p>
<pre><code class="language-bash"><span class="hljs-comment"># Install it first with NPM</span>
$ npm install karma-coffee-preprocessor --save-dev
</code></pre>
<p>And then inside your configuration file...</p>
<pre><code class="language-javascript"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>) </span>{
  config.set({
    <span class="hljs-attr">preprocessors</span>: {
      <span class="hljs-string">&#x27;**/*.coffee&#x27;</span>: [<span class="hljs-string">&#x27;coffee&#x27;</span>]
    }
  });
};
</code></pre>
<p>Of course, you can write <a href="../dev/plugins.html">custom plugins</a> too!</p>
<h2>Configured Preprocessors</h2>
<p>Some of the preprocessors can also be configured:</p>
<pre><code class="language-javascript">coffeePreprocessor: {
  <span class="hljs-attr">options</span>: {
    <span class="hljs-attr">bare</span>: <span class="hljs-literal">false</span>
  }
}
</code></pre>
<p>Or define a configured preprocessor:</p>
<pre><code class="language-javascript">customPreprocessors: {
  <span class="hljs-attr">bare_coffee</span>: {
    <span class="hljs-attr">base</span>: <span class="hljs-string">&#x27;coffee&#x27;</span>,
    <span class="hljs-attr">options</span>: {<span class="hljs-attr">bare</span>: <span class="hljs-literal">true</span>}
  }
}
</code></pre>
<h2>Mini matching</h2>
<p>The keys of the preprocessors config object are used to filter the files specified in
the <code>files</code> configuration.</p>
<ul>
<li>First the file paths are expanded to an absolute path, based on the
<code>basePath</code> configuration and the directory of the configuration file. See
<a href="files.html">files</a> for more information on that.</li>
<li>Then the newly expanded path is matched using <a href="https://github.com/isaacs/minimatch">minimatch</a> against the specified key.</li>
</ul>
<p>So for example the path <code>/my/absolute/path/to/test/unit/file.coffee</code> matched against
the key <code>**/*.coffee</code> would return <code>true</code>, but matched against just <code>*.coffee</code> it would
return <code>false</code> and the preprocessor would not be executed on the CoffeeScript files.</p>
<h2>Order of execution</h2>
<p>If a file matches only one key in the preprocessors config object, then karma
will execute the preprocessors over that file in the order they are listed in
the corresponding array. So for instance, if the config object is:</p>
<pre><code class="language-js">preprocessors: {
  <span class="hljs-string">&#x27;*.js&#x27;</span>: [<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>]
}
</code></pre>
<p>Then karma will execute <code>&#39;a&#39;</code> before executing <code>&#39;b&#39;</code>.</p>
<p>If a file matches multiple keys, karma will use the <code>config.preprocessor_priority</code>
map to set the order. If this config option is not set, karma do its best to
execute the preprocessors in a reasonable order.  So if you have:</p>
<pre><code class="language-js">preprocessors: {
  <span class="hljs-string">&#x27;*.js&#x27;</span>: [<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>],
  <span class="hljs-string">&#x27;a.*&#x27;</span>: [<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>]
}
</code></pre>
<p>then for <code>a.js</code>, karma will run <code>&#39;a&#39;</code> then <code>&#39;b&#39;</code> then <code>&#39;c&#39;</code>.  If two lists contradict each other, like:</p>
<pre><code class="language-js">preprocessors: {
  <span class="hljs-string">&#x27;*.js&#x27;</span>: [<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>],
  <span class="hljs-string">&#x27;a.*&#x27;</span>: [<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>]
}
</code></pre>
<p>then karma will arbitrarily pick one list to prioritize over the other.  In a
case like:</p>
<pre><code class="language-js">preprocessors: {
  <span class="hljs-string">&#x27;*.js&#x27;</span>: [<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>],
  <span class="hljs-string">&#x27;a.*&#x27;</span>: [<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>]
}
</code></pre>
<p>Then <code>&#39;a&#39;</code> will definitely be run first, <code>&#39;d&#39;</code> will definitely be run last, but
it&#39;s arbitrary if karma will run <code>&#39;b&#39;</code> before <code>&#39;c&#39;</code> or vice versa.</p>

        </div>
      </div>
    </div>
    <div class="push"></div>
  </div>
  <footer>
    <div class="container">
      <div class="ten columns"><span class="copyright">
          Karma is released under the MIT license. 
          Site by&nbsp;<a href="https://github.com/Dignifiedquire">Friedel Ziegelmayer</a>. Logo by&nbsp;<a href="http://dribbble.com/isaacdurazo">Isaac Durazo</a>.</span></div>
      <div class="six columns">
        <div class="social"><a href="https://github.com/karma-runner/karma/" data-tooltip="GitHub Repo"><i class="icon-github-alt icon-large"></i></a><a href="https://github.com/karma-runner/karma/issues" data-tooltip="Issues"><i class="icon-beaker icon-large"></i></a><a href="http://twitter.com/JsKarma" data-tooltip="@JsKarma"><i class="icon-twitter icon-large"></i></a><a href="https://groups.google.com/forum/#!forum/karma-users" data-tooltip="Mailing List"><i class="icon-envelope-alt icon-large"></i></a></div>
      </div>
    </div>
  </footer>
</body>
<!-- Placed at the end of the document so the pages load faster-->
<script src="/assets/js/app.js"></script>
<!-- Google Analytics-->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-46195299-1']);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>